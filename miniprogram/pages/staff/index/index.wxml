<!-- pages/staff/index/index.wxml -->
<view class="staff-index-container">
  <!-- é¡¶éƒ¨ä¿¡æ¯ -->
  <view class="header-section">
    <view class="staff-info">
      <view class="avatar">ğŸ‘¤</view>
      <view class="info-text">
        <text class="staff-name">{{staffInfo.name || 'åº—å‘˜'}}</text>
        <text class="staff-role">{{staffInfo.role === 'admin' ? 'ç®¡ç†å‘˜' : 'éªŒå…‰å¸ˆ'}}</text>
      </view>
    </view>
    <view class="header-actions">
      <view class="action-btn" bindtap="goToAdminPanel" wx:if="{{staffInfo.role === 'admin'}}">
        <text>ç®¡ç†åå°</text>
      </view>
    </view>
  </view>

  <!-- æœ¬æœˆç»Ÿè®¡ -->
  <view class="stats-section card">
    <view class="section-header">
      <text class="section-title">ğŸ“Š æœ¬æœˆä¸šç»©</text>
      <text class="month-text">{{currentMonth}}</text>
    </view>
    <view class="stats-grid">
      <view class="stat-item" bindtap="showRevenueDetail">
        <text class="stat-value">Â¥{{monthlyStats.totalRevenue}}</text>
        <text class="stat-label">è¥ä¸šé¢</text>
      </view>
      <view class="stat-item" bindtap="showRechargeDetail">
        <text class="stat-value">Â¥{{monthlyStats.totalRecharge}}</text>
        <text class="stat-label">å……å€¼é‡‘é¢</text>
      </view>
      <view class="stat-item">
        <text class="stat-value">{{monthlyStats.customerCount}}</text>
        <text class="stat-label">æœåŠ¡å®¢æˆ·</text>
      </view>
      <view class="stat-item">
        <text class="stat-value">{{monthlyStats.examCount}}</text>
        <text class="stat-label">éªŒå…‰æ¬¡æ•°</text>
      </view>
    </view>
  </view>

  <!-- å¿«æ·åŠŸèƒ½ -->
  <view class="quick-actions card">
    <view class="section-header">
      <text class="section-title">âš¡ å¿«æ·åŠŸèƒ½</text>
    </view>
    <view class="actions-grid">
      <view class="action-item" bindtap="goToScanner">
        <view class="action-icon scan-icon">ğŸ“·</view>
        <text class="action-name">æ‰«ç æ ¸é”€</text>
      </view>
      <view class="action-item" bindtap="goToCustomerSearch">
        <view class="action-icon search-icon">ğŸ”</view>
        <text class="action-name">å®¢æˆ·æœç´¢</text>
      </view>
      <view class="action-item" bindtap="goToAddExam">
        <view class="action-icon exam-icon">ğŸ“‹</view>
        <text class="action-name">æ·»åŠ éªŒå…‰</text>
      </view>
      <view class="action-item" bindtap="goToRecharge">
        <view class="action-icon recharge-icon">ğŸ’°</view>
        <text class="action-name">å®¢æˆ·å……å€¼</text>
      </view>
    </view>
  </view>

  <!-- å®¢æˆ·è·Ÿè¿›æé†’ -->
  <view class="follow-up-section card">
    <view class="section-header">
      <text class="section-title">â° å¾…è·Ÿè¿›å®¢æˆ·</text>
      <text class="view-all" bindtap="viewAllCustomers">æŸ¥çœ‹å…¨éƒ¨ ></text>
    </view>
    <view class="customer-list" wx:if="{{followUpCustomers.length > 0}}">
      <view class="customer-item" wx:for="{{followUpCustomers}}" wx:key="_id" bindtap="viewCustomerDetail" data-id="{{item._id}}">
        <view class="customer-info">
          <text class="customer-name">{{item.name}}</text>
          <text class="customer-phone">{{item.phone}}</text>
        </view>
        <view class="last-exam">
          <text class="days-text {{item.daysAgo >= 90 ? 'warning' : ''}}">{{item.daysAgo}}å¤©å‰éªŒå…‰</text>
          <view class="contact-btn" catchtap="contactCustomer" data-phone="{{item.phone}}">
            <text>ğŸ“</text>
          </view>
        </view>
      </view>
    </view>
    <view class="empty-state" wx:else>
      <text class="empty-text">æš‚æ— å¾…è·Ÿè¿›å®¢æˆ·</text>
    </view>
  </view>

  <!-- ä»Šæ—¥ä¸šåŠ¡ -->
  <view class="today-section card">
    <view class="section-header">
      <text class="section-title">ğŸ“… ä»Šæ—¥ä¸šåŠ¡</text>
    </view>
    <view class="today-stats">
      <view class="today-item">
        <text class="today-label">éªŒå…‰</text>
        <text class="today-value">{{todayStats.examCount}}æ¬¡</text>
      </view>
      <view class="today-item">
        <text class="today-label">æ ¸é”€</text>
        <text class="today-value">{{todayStats.verifyCount}}æ¬¡</text>
      </view>
      <view class="today-item">
        <text class="today-label">å……å€¼</text>
        <text class="today-value">Â¥{{todayStats.rechargeAmount}}</text>
      </view>
      <view class="today-item">
        <text class="today-label">æ¶ˆè´¹</text>
        <text class="today-value">Â¥{{todayStats.consumeAmount}}</text>
      </view>
    </view>
  </view>

  <!-- é€€å‡ºç™»å½• -->
  <view class="logout-section">
    <button class="logout-btn" bindtap="handleLogout">é€€å‡ºç™»å½•</button>
  </view>
</view>
