<!-- pages/profile/profile.wxml -->
<view class="profile-container">
  <!-- 用户信息头部 -->
  <view class="header-section">
    <view class="user-card" wx:if="{{userInfo}}">
      <image class="avatar" src="{{userInfo.avatarUrl || '/images/default-avatar.png'}}" mode="aspectFill"></image>
      <view class="user-info">
        <text class="nickname">{{userInfo.nickName || '用户'}}</text>
        <text class="user-id">ID: {{userInfo.userId || '--'}}</text>
      </view>
      <view class="edit-btn" bindtap="editProfile">
        <text>编辑</text>
      </view>
    </view>
    <view class="user-card" wx:else bindtap="goToLogin">
      <view class="avatar-placeholder">👤</view>
      <text class="login-tip">点击登录</text>
    </view>
  </view>

  <!-- 用户基本信息 -->
  <view class="info-section card" wx:if="{{userInfo}}">
    <view class="info-item">
      <text class="info-label">性别</text>
      <text class="info-value">{{userInfo.gender === 1 ? '男' : userInfo.gender === 2 ? '女' : '未设置'}}</text>
    </view>
    <view class="info-item">
      <text class="info-label">年龄</text>
      <text class="info-value">{{userInfo.age || '未设置'}}</text>
    </view>
    <view class="info-item">
      <text class="info-label">手机号</text>
      <text class="info-value">{{userInfo.phone || '未绑定'}}</text>
    </view>
  </view>

  <!-- 积分和余额 -->
  <view class="stats-section" wx:if="{{userInfo}}">
    <view class="stat-card">
      <view class="stat-icon">⭐</view>
      <text class="stat-value">{{points}}</text>
      <text class="stat-label">积分</text>
    </view>
    <view class="stat-card" bindtap="showBalanceDetail">
      <view class="stat-icon">💰</view>
      <text class="stat-value">¥{{balance}}</text>
      <text class="stat-label">会员余额</text>
    </view>
    <view class="stat-card" bindtap="showPrizes">
      <view class="stat-icon">🎁</view>
      <text class="stat-value">{{prizeCount}}</text>
      <text class="stat-label">我的奖品</text>
    </view>
  </view>

  <!-- 会员卡区域 -->
  <view class="member-section card" wx:if="{{userInfo}}" bindtap="showQRCode">
    <view class="member-header">
      <view class="member-title">
        <text class="title-icon">💳</text>
        <text>会员卡</text>
      </view>
      <text class="member-level">{{memberLevel}}</text>
    </view>
    <view class="member-content">
      <view class="balance-display">
        <text class="balance-label">可用余额</text>
        <text class="balance-value">¥{{balance}}</text>
      </view>
      <view class="qrcode-tip">
        <text class="qrcode-icon">📱</text>
        <text>点击出示付款码</text>
      </view>
    </view>
  </view>

  <!-- 充值入口 -->
  <view class="recharge-section card" wx:if="{{userInfo}}" bindtap="goToRecharge">
    <view class="recharge-content">
      <view class="recharge-left">
        <text class="recharge-icon">💎</text>
        <view class="recharge-info">
          <text class="recharge-title">会员充值</text>
          <text class="recharge-desc">充值优惠多多</text>
        </view>
      </view>
      <text class="recharge-arrow">></text>
    </view>
    <view class="offer-tags" wx:if="{{rechargeOffers.length > 0}}">
      <view class="offer-tag" wx:for="{{rechargeOffers}}" wx:key="id">
        {{item.text}}
      </view>
    </view>
  </view>

  <!-- 功能菜单 -->
  <view class="menu-section">
    <view class="menu-item" bindtap="goToRecords">
      <view class="menu-left">
        <text class="menu-icon">📋</text>
        <text class="menu-text">我的档案</text>
      </view>
      <text class="menu-arrow">></text>
    </view>
    <view class="menu-item" bindtap="goToLottery">
      <view class="menu-left">
        <text class="menu-icon">🎁</text>
        <text class="menu-text">每日抽奖</text>
      </view>
      <text class="menu-arrow">></text>
    </view>
    <view class="menu-item" bindtap="goToVisionTest">
      <view class="menu-left">
        <text class="menu-icon">👁️</text>
        <text class="menu-text">视力测试</text>
      </view>
      <text class="menu-arrow">></text>
    </view>
    <view class="menu-item" bindtap="contactService">
      <view class="menu-left">
        <text class="menu-icon">📞</text>
        <text class="menu-text">联系客服</text>
      </view>
      <text class="menu-arrow">></text>
    </view>
    <view class="menu-item" bindtap="showAbout">
      <view class="menu-left">
        <text class="menu-icon">ℹ️</text>
        <text class="menu-text">关于我们</text>
      </view>
      <text class="menu-arrow">></text>
    </view>
  </view>

  <!-- 店员入口 -->
  <view class="staff-entry" bindtap="goToStaffLogin">
    <text class="staff-text">我是店员</text>
  </view>

  <!-- 退出登录 -->
  <view class="logout-section" wx:if="{{userInfo}}">
    <button class="logout-btn" bindtap="handleLogout">退出登录</button>
  </view>
</view>
